[zwykle]

SELECT * FROM flights WHERE DEPARTURE_DELAY > 30;

SELECT FLIGHT_NUMBER, DEPARTURE_DELAY FROM flights WHERE CANCELLED = 1;

SELECT YEAR, MONTH, DAY, AIRLINE, FLIGHT_NUMBER, AIR_TIME FROM flights WHERE AIR_TIME > 120;
[grupowanie]

SELECT AIRLINE, AVG(DEPARTURE_DELAY) AS avg_departure_delay FROM flights GROUP BY AIRLINE;

SELECT ORIGIN_AIRPORT, COUNT(*) AS cancelled_flights FROM flights WHERE CANCELLED = 1 GROUP BY ORIGIN_AIRPORT;

SELECT DAY_OF_WEEK, SUM(ARRIVAL_DELAY) AS total_arrival_delay FROM flights GROUP BY DAY_OF_WEEK;
[joiny]
SELECT f.YEAR, f.MONTH, f.DAY, f.FLIGHT_NUMBER, a.AIRLINE FROM flights f JOIN Airlines a ON f.AIRLINE = a.IATA_CODE;

SELECT f.FLIGHT_NUMBER, f.SCHEDULED_DEPARTURE, f.DEPARTURE_DELAY, c.CANCELLATION_REASON FROM flights f JOIN Cancellation_codes c ON f.CANCELLATION_REASON = c.CANCELLATION_REASON WHERE f.CANCELLED = 1;

SELECT f.FLIGHT_NUMBER, f.ARRIVAL_DELAY, a.CITY FROM flights f JOIN Airports a ON f.ORIGIN_AIRPORT = a.IATA_CODE;

[podzapytania]
SELECT * FROM flights WHERE ARRIVAL_DELAY > (SELECT AVG(ARRIVAL_DELAY) FROM flights);

SELECT FLIGHT_NUMBER, SCHEDULED_DEPARTURE, DEPARTURE_DELAY FROM flights WHERE CANCELLED = 1 AND DEPARTURE_DELAY > 30 AND CANCELLATION_REASON = (SELECT CANCELLATION_REASON FROM Cancellation_codes WHERE CANCELLATION_REASON = 'A');

SELECT DAY_OF_WEEK, AVG(ARRIVAL_DELAY) AS avg_arrival_delay FROM flights GROUP BY DAY_OF_WEEK HAVING AVG(ARRIVAL_DELAY) > 5;
